$(document).ready(function(){let t="https://c64-diagnostic.fly.dev";var e={precheck:"",system_power_supply:"",system_reset:"",system_clocks:"",system_video:"",system_ram:"",system_rom_io:""},s=JSON.parse(localStorage.getItem("history"))||[];function c(s){$.ajax({url:t+"/diagnose",type:"POST",dataType:"json",data:JSON.stringify(s),contentType:"application/json; charset=utf-8",success:function(t){localStorage.setItem("diagnostic",JSON.stringify(t)),!0===t.finish?$.get("templates/diagnostic.html",function(s){var c,i=s.replace("{{type}}",t.step.type.replace(/_/g," ")).replace("{{category}}",t.step.category).replace("{{diagnostic}}",t.description).replace("{{color}}",(c=t,c.description===c.step.error.diagnostic?"error-diag":"success-diag")).replace("{{description}}",e[t.step.type]);$(".diagnostic").html(i)},"html"):$.get("templates/test.html",function(s){var c=s.replace("{{step}}",t.step.step).replace("{{type}}",t.step.type.replace(/_/g," ")).replace("{{category}}",t.step.category).replace("{{test}}",t.step.test).replace("{{description}}",e[t.step.type]);$(".diagnostic").html(c)},"html")}})}function i(){$.get("templates/home.html",function(t){$(".diagnostic").html(t)},"html")}i(),$.ajax({url:t+"/metadata",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(t){e.precheck=t.precheck,e.system_power_supply=t.system_power_supply,e.system_reset=t.system_reset,e.system_clocks=t.system_clocks,e.system_video=t.system_video,e.system_ram=t.system_ram,e.system_rom_io=t.system_rom_io}}),$(document).on("click","#start",function(){c({diagnostic:"precheck",step:"1",result:""})}),$(document).on("click","#restart",function(){localStorage.clear(),i()}),$(document).on("click","#reset",function(){localStorage.clear(),i()}),$(document).on("click","#back",function(){var t=(removed=s.pop(),localStorage.setItem("history",JSON.stringify(s)),removed);void 0===t?i():(t.result="",c(t))}),$(document).on("click",".categories li",function(){var t=$(this).data("category");if("continue"===t)var e=function t(){if(null!==localStorage.getItem("diagnostic")){var e=JSON.parse(localStorage.getItem("diagnostic"));return{diagnostic:e.step.type,step:e.step.step,result:""}}return{diagnostic:"precheck",step:"1",result:""}}();else var e={diagnostic:t,step:"1",result:""};c(e)}),$(document).on("click","#resources",function(){$.get("templates/resources.html",function(t){$(".diagnostic").html(t)},"html")}),$(document).on("click","#about",function(){$.get("templates/about.html",function(t){$(".diagnostic").html(t)},"html")}),$(document).on("click","#home ",function(){$.get("templates/home.html",function(t){$(".diagnostic").html(t)},"html")}),$(document).on("click","#continue",function(){var t=$("input[name='answer']:checked");if(t.length>0){$(".error").hide();var e,i=t.val(),o=JSON.parse(localStorage.getItem("diagnostic")),n={diagnostic:o.step.type,step:o.step.step,result:i};e=n,s.push(e),localStorage.setItem("history",JSON.stringify(s)),c(n)}else $(".error").show()})});